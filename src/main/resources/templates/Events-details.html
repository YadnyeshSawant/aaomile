<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{base :: parent(~{::#content},~{::title},~{::script})}">

<head>
    <title>Event Details</title>
    <!-- this page is design to display event information and booking 
     form added to confirm the booking and added user details to db as event booked by this user 
    -->
</head>
<body class="bg-slate-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">
    <section id="content" class="mx-auto">
        <!-- Banner Image Section -->
        <div class="w-full h-[400px] relative mb-8">
            <img th:src="${event.bannerImage != null ? event.bannerImage : '/images/default-banner.jpg'}"
                 class="w-full h-full object-cover" alt="Event banner">
            <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-6">
                <div class="max-w-7xl mx-auto flex justify-between items-end">
                    <div>
                        <h1 class="text-4xl font-bold text-white mb-2" th:text="${event.name}">Event Name</h1>
                        <p class="text-xl text-white/90" th:text="${event.shortDescription}">Event Description</p>
                    </div>
                    <button onclick="showBooking()" 
                            th:if="${event.bookingAvailable}"
                            class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold transition-all transform hover:scale-105">
                        Book Now
                    </button>
                    <span th:unless="${event.bookingAvailable}" 
                          class="bg-gray-500 text-white px-8 py-4 rounded-lg font-semibold">
                        Booking Closed
                    </span>
                </div>
            </div>
        </div>

        <!-- Content Container -->
        <div class="max-w-7xl mx-auto px-4 py-8">
            <!-- Event Description and Details -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg mb-8">
                <div class="max-w-3xl mx-auto">
                    <h2 class="text-2xl font-bold mb-4 text-gray-900 dark:text-gray-200">About the Event</h2>
                    <p class="text-gray-600 dark:text-gray-300 mb-6" th:text="${event.fullDescription}">
                        Full event description here
                    </p>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                            <i class="far fa-calendar-alt text-2xl text-blue-500"></i>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Date</p>
                                <p class="font-semibold text-gray-900 dark:text-gray-200" 
                                   th:text="${#temporals.format(event.date, 'MMMM d, yyyy')}">Date</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                            <i class="far fa-clock text-2xl text-blue-500"></i>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Time</p>
                                <p class="font-semibold text-gray-900 dark:text-gray-200" 
                                   th:text="${#temporals.format(event.time, 'h:mm a')}">Time</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                            <i class="fas fa-map-marker-alt text-2xl text-blue-500"></i>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Location</p>
                                <p class="font-semibold text-gray-900 dark:text-gray-200" 
                                   th:text="${event.venue + ', ' + event.city}">Location</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                            <i class="fas fa-hourglass-half text-2xl text-blue-500"></i>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Duration</p>
                                <p class="font-semibold text-gray-900 dark:text-gray-200" 
                                   th:text="${event.duration}">Duration</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Booking Modal -->
        <div id="bookingSection" class="booking-section">
            <div class="booking-content bg-white dark:bg-gray-800 p-6 rounded-xl shadow-2xl mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-200">Book Tickets</h2>
                    <button onclick="hideBooking()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>

                <form th:action="@{'/events/' + ${event.id} + '/book'}" method="post" class="space-y-6">
                    <div>
                        <label class="block text-gray-700 dark:text-gray-300 mb-2">Number of Tickets</label>
                        <div class="flex items-center space-x-4">
                            <button type="button" onclick="decrementTickets()" 
                                    class="bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-200 px-4 py-2 rounded-lg">-</button>
                            <input type="number" name="ticketCount" id="ticketCount" value="1" 
                                   th:min="1" th:max="${event.maxTicketsPerBooking}"
                                   class="w-20 text-center border rounded-lg py-2 dark:bg-gray-700 text-gray-900 dark:text-gray-200">
                            <button type="button" onclick="incrementTickets()"
                                    class="bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-200 px-4 py-2 rounded-lg">+</button>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300 mb-2">Price per Ticket</label>
                            <p class="text-2xl font-bold text-green-600 dark:text-green-400" 
                               th:text="${'₹' + #numbers.formatDecimal(event.ticketPrice, 0, 'COMMA', 0, 'POINT')}">Price</p>
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300 mb-2">Total Amount</label>
                            <p class="text-2xl font-bold text-green-600 dark:text-green-400">
                                ₹<span id="totalAmount">0</span>
                            </p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <label class="block text-gray-700 dark:text-gray-300 mb-2">Contact Information</label>
                        <input type="text" name="name" placeholder="Full Name" required
                               th:value="${#authentication.principal.name}"
                               class="w-full border rounded-lg p-3 dark:bg-gray-700">
                        <input type="email" name="email" placeholder="Email" required
                               th:value="${#authentication.principal.email}"
                               class="w-full border rounded-lg p-3 dark:bg-gray-700">
                        <input type="tel" name="phone" placeholder="Phone Number" required
                               th:value="${#authentication.principal.phone}"
                               class="w-full border rounded-lg p-3 dark:bg-gray-700">
                    </div>

                    <input type="hidden" name="eventId" th:value="${event.id}">
                    <input type="hidden" name="_csrf" th:value="${_csrf.token}">

                    <button type="submit" 
                            class="w-full bg-blue-500 text-white py-4 px-6 rounded-lg hover:bg-blue-600 transition duration-300 font-semibold">
                        Proceed to Payment
                    </button>
                </form>
            </div>
        </div>
    </section>

    <script th:inline="javascript">
        // Get dynamic values from Thymeleaf
        const ticketPrice = /*[[${event.ticketPrice}]]*/ 1500;
        const maxTickets = /*[[${event.maxTicketsPerBooking}]]*/ 10;
        
        function showBooking() {
            document.getElementById('bookingSection').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hideBooking() {
            document.getElementById('bookingSection').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function updateTotal() {
            const count = parseInt(document.getElementById('ticketCount').value);
            const total = count * ticketPrice;
            document.getElementById('totalAmount').textContent = 
                total.toLocaleString('en-IN');
        }

        function incrementTickets() {
            const input = document.getElementById('ticketCount');
            if (input.value < maxTickets) {
                input.value = parseInt(input.value) + 1;
                updateTotal();
            }
        }

        function decrementTickets() {
            const input = document.getElementById('ticketCount');
            if (input.value > 1) {
                input.value = parseInt(input.value) - 1;
                updateTotal();
            }
        }

        document.getElementById('ticketCount').addEventListener('change', updateTotal);

        // Initialize total amount
        updateTotal();

        // Close modal when clicking outside
        document.getElementById('bookingSection').addEventListener('click', function(e) {
            if (e.target === this) {
                hideBooking();
            }
        });
    </script>
</body>
</html>
<!-- 
     If you want to see how this page will look like the comment out the above code and uncomment the below code.
-->

<!-- 
<!DOCTYPE html>
<html>
<head>
    <title>Event Details</title>
    <style>
        .booking-section {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
        }

        .booking-section.active {
            display: block;
        }

        .booking-content {
            max-width: 600px;
            margin: 2rem auto;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-slate-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">
    
        <div class="w-full h-[400px] relative mb-8">
          <img src="/sample-event-banner.jpg"
               class="w-full h-full object-cover" alt="Event banner">
          <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-6">
              <div class="max-w-7xl mx-auto flex justify-between items-end">
                  <div>
                      <h1 class="text-4xl font-bold text-white mb-2">Summer Music Festival 2024</h1>
                      <p class="text-xl text-white/90">Join us for an amazing evening of live music</p>
                  </div>
                  <button onclick="showBooking()" 
                          class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold transition-all transform hover:scale-105">
                      Book Now
                  </button>
              </div>
          </div>
      </div>

   
      <div class="max-w-7xl mx-auto px-4 py-8">
           
          <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg mb-8">
              <div class="max-w-3xl mx-auto">
                  <h2 class="text-2xl font-bold mb-4">About the Event</h2>
                  <p class="text-gray-600 dark:text-gray-300 mb-6">
                      Join us for an amazing evening of live music featuring top artists from around the world. 
                      Experience an unforgettable night of entertainment, food, and celebration.
                  </p>
                  
                  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                      <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                          <i class="far fa-calendar-alt text-2xl text-blue-500"></i>
                          <div>
                              <p class="text-sm text-gray-500 dark:text-gray-400">Date</p>
                              <p class="font-semibold">March 15, 2024</p>
                          </div>
                      </div>
                      <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                          <i class="far fa-clock text-2xl text-blue-500"></i>
                          <div>
                              <p class="text-sm text-gray-500 dark:text-gray-400">Time</p>
                              <p class="font-semibold">7:00 PM</p>
                          </div>
                      </div>
                      <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                          <i class="fas fa-map-marker-alt text-2xl text-blue-500"></i>
                          <div>
                              <p class="text-sm text-gray-500 dark:text-gray-400">Location</p>
                              <p class="font-semibold">Central Park, New York</p>
                          </div>
                      </div>
                      <div class="flex items-center space-x-3 bg-slate-50 dark:bg-gray-700 p-4 rounded-lg">
                          <i class="fas fa-hourglass-half text-2xl text-blue-500"></i>
                          <div>
                              <p class="text-sm text-gray-500 dark:text-gray-400">Duration</p>
                              <p class="font-semibold">3 hours</p>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>

      
      <div id="bookingSection" class="booking-section">
          <div class="booking-content bg-white dark:bg-gray-800 p-6 rounded-xl shadow-2xl mx-4">
              <div class="flex justify-between items-center mb-6">
                  <h2 class="text-2xl font-bold">Book Tickets</h2>
                  <button onclick="hideBooking()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                      <i class="fas fa-times text-2xl"></i>
                  </button>
              </div>

              <form action="/event/123/book" method="post" class="space-y-6">
                  <div>
                      <label class="block text-gray-700 dark:text-gray-300 mb-2">Number of Tickets</label>
                      <div class="flex items-center space-x-4">
                          <button type="button" onclick="decrementTickets()" 
                                  class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-lg">-</button>
                          <input type="number" name="ticketCount" id="ticketCount" value="1" min="1" max="10"
                                 class="w-20 text-center border rounded-lg py-2 dark:bg-gray-700">
                          <button type="button" onclick="incrementTickets()"
                                  class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-lg">+</button>
                      </div>
                  </div>

                  <div class="grid grid-cols-2 gap-4">
                      <div>
                          <label class="block text-gray-700 dark:text-gray-300 mb-2">Price per Ticket</label>
                          <p class="text-2xl font-bold text-green-600 dark:text-green-400">₹1500</p>
                      </div>
                      <div>
                          <label class="block text-gray-700 dark:text-gray-300 mb-2">Total Amount</label>
                          <p class="text-2xl font-bold text-green-600 dark:text-green-400">
                              ₹<span id="totalAmount">1500</span>
                          </p>
                      </div>
                  </div>

                  <div class="space-y-4">
                      <label class="block text-gray-700 dark:text-gray-300 mb-2">Contact Information</label>
                      <input type="text" name="name" placeholder="Full Name" required
                             class="w-full border rounded-lg p-3 dark:bg-gray-700">
                      <input type="email" name="email" placeholder="Email" required
                             class="w-full border rounded-lg p-3 dark:bg-gray-700">
                      <input type="tel" name="phone" placeholder="Phone Number" required
                             class="w-full border rounded-lg p-3 dark:bg-gray-700">
                  </div>

                  <button type="submit" 
                          class="w-full bg-blue-500 text-white py-4 px-6 rounded-lg hover:bg-blue-600 transition duration-300 font-semibold">
                      Proceed to Payment
                  </button>
              </form>
          </div>
      </div>
  </div>

  <script>
      const ticketPrice = 1500;
      
      function showBooking() {
          document.getElementById('bookingSection').classList.add('active');
          document.body.style.overflow = 'hidden';
      }

      function hideBooking() {
          document.getElementById('bookingSection').classList.remove('active');
          document.body.style.overflow = 'auto';
      }

      function updateTotal() {
          const count = parseInt(document.getElementById('ticketCount').value);
          const total = count * ticketPrice;
          document.getElementById('totalAmount').textContent = total;
      }

      function incrementTickets() {
          const input = document.getElementById('ticketCount');
          if (input.value < 10) {
              input.value = parseInt(input.value) + 1;
              updateTotal();
          }
      }

      function decrementTickets() {
          const input = document.getElementById('ticketCount');
          if (input.value > 1) {
              input.value = parseInt(input.value) - 1;
              updateTotal();
          }
      }

      document.getElementById('ticketCount').addEventListener('change', updateTotal);

       
      document.getElementById('bookingSection').addEventListener('click', function(e) {
          if (e.target === this) {
              hideBooking();
          }
      });
  </script>
</body>
</html>

-->